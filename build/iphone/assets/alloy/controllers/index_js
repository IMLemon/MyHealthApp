function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(r){if(!r||!r.fromAdapter){e.opts||{};for(var n=c.models,o=n.length,s=[],l=0;o>l;l++){var _=n[l];_.__transform={};var h=Ti.UI.createTableViewRow({height:"40"});s.push(h);var u=Ti.UI.createLabel({width:"60%",height:Ti.UI.SIZE,color:"#000",font:{fontSize:20,fontFamily:"Helvetica Neue"},textAlign:Ti.UI.TEXT_ALIGNMENT_LEFT,text:"undefined"!=typeof _.__transform.name?_.__transform.name:_.get("name"),left:"10"});h.add(u);var p=Ti.UI.createSwitch({left:"60%",auth_id:"undefined"!=typeof _.__transform.id?_.__transform.id:_.get("id"),value:"undefined"!=typeof _.__transform.shareRequested?_.__transform.shareRequested:_.get("shareRequested"),enabled:"undefined"!=typeof _.__transform.shareEnabled?_.__transform.shareEnabled:_.get("shareEnabled")});h.add(p),t?a.addListener(p,"change",t):d["__alloyId15!change!shareChanged"]=!0;var f=Ti.UI.createSwitch({right:"5",auth_id:"undefined"!=typeof _.__transform.id?_.__transform.id:_.get("id"),value:"undefined"!=typeof _.__transform.readRequested?_.__transform.readRequested:_.get("readRequested"),enabled:"undefined"!=typeof _.__transform.readEnabled?_.__transform.readEnabled:_.get("readEnabled")});h.add(f),i?a.addListener(f,"change",i):d["__alloyId17!change!readChanged"]=!0}a.__views.__alloyId8.setData(s)}}function t(e){var t=Alloy.Collections.authorizations.get(e.source.auth_id);t.set({shareRequested:e.source.value}),t.save()}function i(e){var t=Alloy.Collections.authorizations.get(e.source.auth_id);t.set({readRequested:e.source.value}),t.save()}function r(){var e=[],t=[],i=Alloy.Collections.authorizations.where({shareRequested:!0});i.forEach(function(t){e.push(t.get("type")),t.set({shareEnabled:!1}),t.save()});var i=Alloy.Collections.authorizations.where({readRequested:!0});i.forEach(function(e){t.push(e.get("type")),e.set({readEnabled:!1}),e.save()}),TiHealthkit.requestAuthorization({typesToRead:t,typesToShare:e,onCompletion:function(e){e.success?console.log("Do nothing!!"):alert("Failed to request authorizations!")}})}function n(){switch(a.typePicker.getSelectedRow(0).title){case"Running":type=TiHealthkit.WORKOUT_ACTIVITY_TYPE_RUNNING;break;case"Soccer":type=TiHealthkit.WORKOUT_ACTIVITY_TYPE_SOCCER;break;case"Tennis":type=TiHealthkit.WORKOUT_ACTIVITY_TYPE_TENNIS;break;case"Yoga":type=TiHealthkit.WORKOUT_ACTIVITY_TYPE_YOGA}workout=TiHealthkit.createWorkout({type:type,startDate:a.startPicker.value,endDate:a.endPicker.value}),TiHealthkit.saveObjects({objects:[workout],onCompletion:function(e){e.success&&console.log("Success!"),type==TiHealthkit.WORKOUT_ACTIVITY_TYPE_RUNNING&&(sample=TiHealthkit.createQuantitySample({type:TiHealthkit.OBJECT_TYPE_DISTANCE_WALKING_RUNNING,quantity:TiHealthkit.createQuantity(10,TiHealthkit.createUnit("km")),startDate:a.startPicker.value,endDate:a.endPicker.value}),TiHealthkit.addSamplesToWorkout({samples:[sample],workout:workout,onCompletion:function(e){console.log(e.success?"Adding of workout samples succeeded.":e)}}))}})}function o(){var e=TiHealthkit.createObserverQuery({type:TiHealthkit.OBJECT_TYPE_BODY_MASS_INDEX,onUpdate:function(e){return void 0!==e.errorCode?void console.log(e):void s()}});TiHealthkit.executeQuery(e)}function s(){TiHealthkit.executeQuery(TiHealthkit.createAnchoredObjectQuery({type:TiHealthkit.OBJECT_TYPE_BODY_MASS_INDEX,anchor:p,onCompletion:function(e){console.log("Retrieved "+e.results.length+" new entries."),0===e.results.length&&void 0!==p?(p=void 0,s()):(p=e.anchor,e.results.forEach(function(e){var t=e.quantity.valueForUnit(f).toString();a.bmi_label.text="Latest BMI is "+t}))}}))}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="index",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var a=this,l={},d={};Alloy.Collections.instance("authorizations");var h=[];a.__views.__alloyId4=Ti.UI.createWindow({backgroundColor:"#fff",title:"Authorizations",id:"__alloyId4"}),a.__views.__alloyId5=Ti.UI.createView({top:"0",height:"20",id:"__alloyId5"}),a.__views.__alloyId4.add(a.__views.__alloyId5),a.__views.__alloyId6=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#000",font:{fontSize:20,fontFamily:"Helvetica Neue"},textAlign:"center",text:"Share",left:"60%",id:"__alloyId6"}),a.__views.__alloyId5.add(a.__views.__alloyId6),a.__views.__alloyId7=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#000",font:{fontSize:20,fontFamily:"Helvetica Neue"},textAlign:"center",text:"Read",right:"5",id:"__alloyId7"}),a.__views.__alloyId5.add(a.__views.__alloyId7),a.__views.__alloyId8=Ti.UI.createTableView({top:"20",bottom:"40",id:"__alloyId8"}),a.__views.__alloyId4.add(a.__views.__alloyId8);var c=Alloy.Collections.authorizations||authorizations;c.on("fetch destroy change add remove reset",e),a.__views.__alloyId20=Ti.UI.createButton({title:"Request Authorization",bottom:"0",id:"__alloyId20"}),a.__views.__alloyId4.add(a.__views.__alloyId20),r?a.addListener(a.__views.__alloyId20,"click",r):d["$.__views.__alloyId20!click!onRequestAuthClick"]=!0,a.__views.__alloyId3=Ti.UI.createTab({window:a.__views.__alloyId4,title:"Authorizations",icon:"KS_nav_ui.png",id:"__alloyId3"}),h.push(a.__views.__alloyId3),a.__views.__alloyId22=Ti.UI.createWindow({backgroundColor:"#fff",title:"Workout",layout:"vertical",id:"__alloyId22"}),a.__views.__alloyId23=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#000",font:{fontSize:20,fontFamily:"Helvetica Neue"},textAlign:"center",text:"Choose workout type",id:"__alloyId23"}),a.__views.__alloyId22.add(a.__views.__alloyId23),a.__views.typePicker=Ti.UI.createPicker({id:"typePicker",selectionIndicator:"true",height:"200"}),a.__views.__alloyId22.add(a.__views.typePicker);var u=[];a.__views.__alloyId25=Ti.UI.createPickerRow({title:"Running",id:"__alloyId25"}),u.push(a.__views.__alloyId25),a.__views.__alloyId26=Ti.UI.createPickerRow({title:"Soccer",id:"__alloyId26"}),u.push(a.__views.__alloyId26),a.__views.__alloyId27=Ti.UI.createPickerRow({title:"Tennis",id:"__alloyId27"}),u.push(a.__views.__alloyId27),a.__views.__alloyId28=Ti.UI.createPickerRow({title:"Yoga",id:"__alloyId28"}),u.push(a.__views.__alloyId28),a.__views.typePicker.add(u),a.__views.__alloyId29=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#000",font:{fontSize:20,fontFamily:"Helvetica Neue"},textAlign:"center",text:"Start Time",id:"__alloyId29"}),a.__views.__alloyId22.add(a.__views.__alloyId29),a.__views.startPicker=Ti.UI.createPicker({format24:!1,calendarViewShown:!1,id:"startPicker",selectionIndicator:"true",height:"100",type:Ti.UI.PICKER_TYPE_TIME}),a.__views.__alloyId22.add(a.__views.startPicker),a.__views.__alloyId30=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#000",font:{fontSize:20,fontFamily:"Helvetica Neue"},textAlign:"center",text:"End Time",id:"__alloyId30"}),a.__views.__alloyId22.add(a.__views.__alloyId30),a.__views.endPicker=Ti.UI.createPicker({format24:!1,calendarViewShown:!1,id:"endPicker",selectionIndicator:"true",top:"10",height:"100",type:Ti.UI.PICKER_TYPE_TIME}),a.__views.__alloyId22.add(a.__views.endPicker),a.__views.addEventButton=Ti.UI.createButton({id:"addEventButton",title:"Add Event",bottom:"10"}),a.__views.__alloyId22.add(a.__views.addEventButton),n?a.addListener(a.__views.addEventButton,"click",n):d["$.__views.addEventButton!click!onAddEventButtonClick"]=!0,a.__views.__alloyId21=Ti.UI.createTab({window:a.__views.__alloyId22,title:"Workout",icon:"KS_nav_views.png",id:"__alloyId21"}),h.push(a.__views.__alloyId21),a.__views.__alloyId32=Ti.UI.createWindow({backgroundColor:"#fff",title:"BMI",id:"__alloyId32"}),a.__views.__alloyId33=Ti.UI.createButton({title:"Read latest BMI data",top:"100",id:"__alloyId33"}),a.__views.__alloyId32.add(a.__views.__alloyId33),o?a.addListener(a.__views.__alloyId33,"click",o):d["$.__views.__alloyId33!click!bmiClick"]=!0,a.__views.bmi_label=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#000",font:{fontSize:20,fontFamily:"Helvetica Neue"},textAlign:"center",id:"bmi_label"}),a.__views.__alloyId32.add(a.__views.bmi_label),a.__views.__alloyId31=Ti.UI.createTab({window:a.__views.__alloyId32,title:"BMI",icon:"KS_nav_views.png",id:"__alloyId31"}),h.push(a.__views.__alloyId31),a.__views.index=Ti.UI.createTabGroup({tabs:h,id:"index"}),a.__views.index&&a.addTopLevelView(a.__views.index),l.destroy=function(){c.off("fetch destroy change add remove reset",e)},_.extend(a,a.__views),a.index.open(),Alloy.Collections.authorizations.create({id:1,type:TiHealthkit.OBJECT_TYPE_BODY_FAT_PERCENTAGE,name:"Body Fat Percentage",shareRequested:!1,readRequested:!1,shareEnabled:!0,readEnabled:!0}),Alloy.Collections.authorizations.create({id:2,type:TiHealthkit.OBJECT_TYPE_BODY_MASS_INDEX,name:"Body Mass Index",shareRequested:!1,readRequested:!1,shareEnabled:!0,readEnabled:!0}),Alloy.Collections.authorizations.create({id:3,type:TiHealthkit.OBJECT_TYPE_WORKOUT,name:"Workout",shareRequested:!1,readRequested:!1,shareEnabled:!0,readEnabled:!0}),Alloy.Collections.authorizations.create({id:4,type:TiHealthkit.OBJECT_TYPE_DISTANCE_WALKING_RUNNING,name:"Distance Walking Running",shareRequested:!1,readRequested:!1,shareEnabled:!0,readEnabled:!0});var p=void 0,f=TiHealthkit.createUnit("count");d["__alloyId15!change!shareChanged"]&&a.addListener(__alloyId15,"change",t),d["__alloyId17!change!readChanged"]&&a.addListener(__alloyId17,"change",i),d["$.__views.__alloyId20!click!onRequestAuthClick"]&&a.addListener(a.__views.__alloyId20,"click",r),d["$.__views.addEventButton!click!onAddEventButtonClick"]&&a.addListener(a.__views.addEventButton,"click",n),d["$.__views.__alloyId33!click!bmiClick"]&&a.addListener(a.__views.__alloyId33,"click",o),_.extend(a,l)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;